
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Utilities &#8212; ANTsPyNet 0.0.1 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Architectures" href="architectures.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="utilities">
<h1>Utilities<a class="headerlink" href="#utilities" title="Permalink to this headline">¶</a></h1>
<div class="section" id="custom-metrics">
<h2>Custom metrics<a class="headerlink" href="#custom-metrics" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="antspynet.utilities.multilabel_dice_coefficient">
<code class="sig-prename descclassname">antspynet.utilities.</code><code class="sig-name descname">multilabel_dice_coefficient</code><span class="sig-paren">(</span><em class="sig-param">y_true</em>, <em class="sig-param">y_pred</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/antspynet/utilities/custom_metrics.html#multilabel_dice_coefficient"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#antspynet.utilities.multilabel_dice_coefficient" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="antspynet.utilities.peak_signal_to_noise_ratio">
<code class="sig-prename descclassname">antspynet.utilities.</code><code class="sig-name descname">peak_signal_to_noise_ratio</code><span class="sig-paren">(</span><em class="sig-param">y_true</em>, <em class="sig-param">y_pred</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/antspynet/utilities/custom_metrics.html#peak_signal_to_noise_ratio"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#antspynet.utilities.peak_signal_to_noise_ratio" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="antspynet.utilities.pearson_correlation_coefficient">
<code class="sig-prename descclassname">antspynet.utilities.</code><code class="sig-name descname">pearson_correlation_coefficient</code><span class="sig-paren">(</span><em class="sig-param">y_true</em>, <em class="sig-param">y_pred</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/antspynet/utilities/custom_metrics.html#pearson_correlation_coefficient"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#antspynet.utilities.pearson_correlation_coefficient" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="antspynet.utilities.categorical_focal_gain">
<code class="sig-prename descclassname">antspynet.utilities.</code><code class="sig-name descname">categorical_focal_gain</code><span class="sig-paren">(</span><em class="sig-param">y_true</em>, <em class="sig-param">y_pred</em>, <em class="sig-param">gamma=2.0</em>, <em class="sig-param">alpha=0.25</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/antspynet/utilities/custom_metrics.html#categorical_focal_gain"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#antspynet.utilities.categorical_focal_gain" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="antspynet.utilities.categorical_focal_loss">
<code class="sig-prename descclassname">antspynet.utilities.</code><code class="sig-name descname">categorical_focal_loss</code><span class="sig-paren">(</span><em class="sig-param">y_true</em>, <em class="sig-param">y_pred</em>, <em class="sig-param">gamma=2.0</em>, <em class="sig-param">alpha=0.25</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/antspynet/utilities/custom_metrics.html#categorical_focal_loss"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#antspynet.utilities.categorical_focal_loss" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="antspynet.utilities.weighted_categorical_crossentropy">
<code class="sig-prename descclassname">antspynet.utilities.</code><code class="sig-name descname">weighted_categorical_crossentropy</code><span class="sig-paren">(</span><em class="sig-param">y_true</em>, <em class="sig-param">y_pred</em>, <em class="sig-param">weights</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/antspynet/utilities/custom_metrics.html#weighted_categorical_crossentropy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#antspynet.utilities.weighted_categorical_crossentropy" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="custom-normalization-layers">
<h2>Custom normalization layers<a class="headerlink" href="#custom-normalization-layers" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="antspynet.utilities.InstanceNormalization">
<em class="property">class </em><code class="sig-prename descclassname">antspynet.utilities.</code><code class="sig-name descname">InstanceNormalization</code><span class="sig-paren">(</span><em class="sig-param">axis=None</em>, <em class="sig-param">epsilon=0.001</em>, <em class="sig-param">center=True</em>, <em class="sig-param">scale=True</em>, <em class="sig-param">beta_initializer='zeros'</em>, <em class="sig-param">gamma_initializer='ones'</em>, <em class="sig-param">beta_regularizer=None</em>, <em class="sig-param">gamma_regularizer=None</em>, <em class="sig-param">beta_constraint=None</em>, <em class="sig-param">gamma_constraint=None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/antspynet/utilities/custom_normalization_layers.html#InstanceNormalization"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#antspynet.utilities.InstanceNormalization" title="Permalink to this definition">¶</a></dt>
<dd><p>Instance normalization layer.</p>
<p>Normalize the activations of the previous layer at each step,
i.e. applies a transformation that maintains the mean activation
close to 0 and the activation standard deviation close to 1.</p>
<p>Taken from</p>
<p><a class="reference external" href="https://github.com/keras-team/keras-contrib/blob/master/keras_contrib/layers/normalization/instancenormalization.py">https://github.com/keras-team/keras-contrib/blob/master/keras_contrib/layers/normalization/instancenormalization.py</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>axis</strong> (<em>integer</em>) – Integer specifying which axis should be normalized, typically
the feature axis.  For example, after a Conv2D layer with
<cite>channels_first</cite>, set axis = 1.  Setting <cite>axis=-1L</cite> will
normalize all values in each instance of the batch.  Axis 0
is the batch dimension for tensorflow backend so we throw an
error if <cite>axis = 0</cite>.</p></li>
<li><p><strong>epsilon</strong> (<em>float</em>) – Small float added to variance to avoid dividing by zero.</p></li>
<li><p><strong>center</strong> (If True, add offset of <cite>beta</cite> to normalized tensor.) – If False, <cite>beta</cite> is ignored.</p></li>
<li><p><strong>scale</strong> (If True, multiply by <cite>gamma</cite>.) – If False, <cite>gamma</cite> is not used.  When the next layer is linear (also e.g.,
<cite>nn.relu</cite>), this can be disabled since the scaling will be done by the
next layer.</p></li>
<li><p><strong>beta_initializer</strong> (<em>string</em>) – Initializer for the beta weight.</p></li>
<li><p><strong>gamma_initializer</strong> (<em>string</em>) – Initializer for the gamma weight.</p></li>
<li><p><strong>beta_regularizer</strong> (<em>string</em>) – Optional regularizer for the beta weight.</p></li>
<li><p><strong>gamma_regularizer</strong> (<em>string</em>) – Optional regularizer for the gamma weight.</p></li>
<li><p><strong>beta_constraint</strong> (<em>string</em>) – Optional constraint for the beta weight.</p></li>
<li><p><strong>gamma_constraint</strong> (<em>string</em>) – Optional constraint for the gamma weight.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Keras layer</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="custom-activation-layers">
<h2>Custom activation layers<a class="headerlink" href="#custom-activation-layers" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="antspynet.utilities.LogSoftmax">
<em class="property">class </em><code class="sig-prename descclassname">antspynet.utilities.</code><code class="sig-name descname">LogSoftmax</code><span class="sig-paren">(</span><em class="sig-param">axis=-1</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/antspynet/utilities/custom_activation_layers.html#LogSoftmax"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#antspynet.utilities.LogSoftmax" title="Permalink to this definition">¶</a></dt>
<dd><p>Log Softmax activation function.</p>
<dl class="simple">
<dt>Input shape:</dt><dd><p>Arbitrary. Use the keyword argument <cite>input_shape</cite>
(tuple of integers, does not include the samples axis)
when using this layer as the first layer in a model.</p>
</dd>
<dt>Output shape:</dt><dd><p>Same shape as the input.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>axis</strong> – Integer, axis along which the softmax normalization is applied.</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="resample-tensor-layer">
<h2>Resample tensor layer<a class="headerlink" href="#resample-tensor-layer" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="antspynet.utilities.ResampleTensorLayer2D">
<em class="property">class </em><code class="sig-prename descclassname">antspynet.utilities.</code><code class="sig-name descname">ResampleTensorLayer2D</code><span class="sig-paren">(</span><em class="sig-param">shape</em>, <em class="sig-param">interpolation_type='nearest_neighbor'</em>, <em class="sig-param">name=''</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/antspynet/utilities/resample_tensor_utilities.html#ResampleTensorLayer2D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#antspynet.utilities.ResampleTensorLayer2D" title="Permalink to this definition">¶</a></dt>
<dd><p>Tensor resampling layer (2D).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shape</strong> (<em>tuple</em>) – Specifies the output shape of the resampled tensor.</p></li>
<li><p><strong>interpolation_type</strong> (<em>string</em>) – One of ‘nearest_neighbor’, ‘linear’, or ‘cubic’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A keras layer</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Keras layer</p>
</dd>
</dl>
</dd></dl>

<dl class="class">
<dt id="antspynet.utilities.ResampleTensorLayer3D">
<em class="property">class </em><code class="sig-prename descclassname">antspynet.utilities.</code><code class="sig-name descname">ResampleTensorLayer3D</code><span class="sig-paren">(</span><em class="sig-param">shape</em>, <em class="sig-param">interpolation_type='nearest_neighbor'</em>, <em class="sig-param">name=''</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/antspynet/utilities/resample_tensor_utilities.html#ResampleTensorLayer3D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#antspynet.utilities.ResampleTensorLayer3D" title="Permalink to this definition">¶</a></dt>
<dd><p>Tensor resampling layer (3D).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shape</strong> (<em>tuple</em>) – Specifies the output shape of the resampled tensor.</p></li>
<li><p><strong>interpolation_type</strong> (<em>string</em>) – One of ‘nearest_neighbor’, ‘linear’, or ‘cubic’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A keras layer</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Keras layer</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="mixture-density-networks">
<h2>Mixture density networks<a class="headerlink" href="#mixture-density-networks" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="antspynet.utilities.MixtureDensityLayer">
<em class="property">class </em><code class="sig-prename descclassname">antspynet.utilities.</code><code class="sig-name descname">MixtureDensityLayer</code><span class="sig-paren">(</span><em class="sig-param">output_dimension</em>, <em class="sig-param">number_of_mixtures</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/antspynet/utilities/mixture_density_utilities.html#MixtureDensityLayer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#antspynet.utilities.MixtureDensityLayer" title="Permalink to this definition">¶</a></dt>
<dd><p>Layer for modeling arbitrary functions using neural networks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>output_dimension</strong> (<em>integer</em>) – Dimensionality of the output.</p></li>
<li><p><strong>number_of_mixtures</strong> (<em>integer</em>) – Number of gaussians used.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A keras layer</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Layer</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="antspynet.utilities.get_mixture_density_loss_function">
<code class="sig-prename descclassname">antspynet.utilities.</code><code class="sig-name descname">get_mixture_density_loss_function</code><span class="sig-paren">(</span><em class="sig-param">output_dimension</em>, <em class="sig-param">number_of_mixtures</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/antspynet/utilities/mixture_density_utilities.html#get_mixture_density_loss_function"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#antspynet.utilities.get_mixture_density_loss_function" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a loss function for the mixture density.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>output_dimension</strong> (<em>integer</em>) – Dimensionality of the output.</p></li>
<li><p><strong>number_of_mixtures</strong> (<em>integer</em>) – Number of gaussians used.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A function providing the mean square error accuracy</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Function</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="attention">
<h2>Attention<a class="headerlink" href="#attention" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="antspynet.utilities.AttentionLayer2D">
<em class="property">class </em><code class="sig-prename descclassname">antspynet.utilities.</code><code class="sig-name descname">AttentionLayer2D</code><span class="sig-paren">(</span><em class="sig-param">number_of_channels</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/antspynet/utilities/attention_utilities.html#AttentionLayer2D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#antspynet.utilities.AttentionLayer2D" title="Permalink to this definition">¶</a></dt>
<dd><p>Attention layer (2-D) from the self attention GAN</p>
<p>taken from the following python implementation</p>
<p><a class="reference external" href="https://stackoverflow.com/questions/50819931/self-attention-gan-in-keras">https://stackoverflow.com/questions/50819931/self-attention-gan-in-keras</a></p>
<p>based on the following paper:</p>
<p><a class="reference external" href="https://arxiv.org/abs/1805.08318">https://arxiv.org/abs/1805.08318</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>number_of_channels</strong> (<em>integer</em>) – Number of channels</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A keras layer</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Layer</p>
</dd>
</dl>
</dd></dl>

<dl class="class">
<dt id="antspynet.utilities.AttentionLayer3D">
<em class="property">class </em><code class="sig-prename descclassname">antspynet.utilities.</code><code class="sig-name descname">AttentionLayer3D</code><span class="sig-paren">(</span><em class="sig-param">number_of_channels</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/antspynet/utilities/attention_utilities.html#AttentionLayer3D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#antspynet.utilities.AttentionLayer3D" title="Permalink to this definition">¶</a></dt>
<dd><p>Attention layer (3-D) from the self attention GAN</p>
<p>taken from the following python implementation</p>
<p><a class="reference external" href="https://stackoverflow.com/questions/50819931/self-attention-gan-in-keras">https://stackoverflow.com/questions/50819931/self-attention-gan-in-keras</a></p>
<p>based on the following paper:</p>
<p><a class="reference external" href="https://arxiv.org/abs/1805.08318">https://arxiv.org/abs/1805.08318</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>number_of_channels</strong> (<em>integer</em>) – Number of channels</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A keras layer</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Layer</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">input_shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">input</span> <span class="o">=</span> <span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">input_shape</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">number_of_filters</span> <span class="o">=</span> <span class="mi">64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">outputs</span> <span class="o">=</span> <span class="n">Conv2D</span><span class="p">(</span><span class="n">filters</span><span class="o">=</span><span class="n">number_of_filters</span><span class="p">,</span> <span class="n">kernel_size</span><span class="o">=</span><span class="mi">2</span><span class="p">)(</span><span class="nb">input</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">outputs</span> <span class="o">=</span> <span class="n">AttentionLayer2D</span><span class="p">(</span><span class="n">number_of_channels</span><span class="o">=</span><span class="n">number_of_filters</span><span class="p">)(</span><span class="n">outputs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">inputs</span><span class="o">=</span><span class="nb">input</span><span class="p">,</span> <span class="n">outputs</span><span class="o">=</span><span class="n">outputs</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="clustering">
<h2>Clustering<a class="headerlink" href="#clustering" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="antspynet.utilities.DeepEmbeddedClustering">
<em class="property">class </em><code class="sig-prename descclassname">antspynet.utilities.</code><code class="sig-name descname">DeepEmbeddedClustering</code><span class="sig-paren">(</span><em class="sig-param">number_of_clusters=10</em>, <em class="sig-param">initial_cluster_weights=None</em>, <em class="sig-param">alpha=1.0</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/antspynet/utilities/deep_embedded_clustering_utilities.html#DeepEmbeddedClustering"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#antspynet.utilities.DeepEmbeddedClustering" title="Permalink to this definition">¶</a></dt>
<dd><p>Deep embedded lustering layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>number_of_clusters</strong> (<em>integer</em>) – Specifies which axis to normalize.</p></li>
<li><p><strong>initial_cluster_weights</strong> (<em>list</em>) – Initial clustering weights.</p></li>
<li><p><strong>alpha</strong> (<em>scalar</em>) – Parameter.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A keras layer</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Keras layer</p>
</dd>
</dl>
</dd></dl>

<dl class="class">
<dt id="antspynet.utilities.DeepEmbeddedClusteringModel">
<em class="property">class </em><code class="sig-prename descclassname">antspynet.utilities.</code><code class="sig-name descname">DeepEmbeddedClusteringModel</code><span class="sig-paren">(</span><em class="sig-param">number_of_units_per_layer=None</em>, <em class="sig-param">number_of_clusters=10</em>, <em class="sig-param">alpha=1.0</em>, <em class="sig-param">initializer='glorot_uniform'</em>, <em class="sig-param">convolutional=False</em>, <em class="sig-param">input_image_size=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/antspynet/utilities/deep_embedded_clustering_utilities.html#DeepEmbeddedClusteringModel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#antspynet.utilities.DeepEmbeddedClusteringModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Deep embedded clustering with and without convolutions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>number_of_units_per_layer</strong> (<em>integer</em>) – Autoencoder number of units per layer.</p></li>
<li><p><strong>number_of_clusters</strong> (<em>integer</em>) – Number of clusters.</p></li>
<li><p><strong>alpha</strong> (<em>scalar</em>) – Parameter</p></li>
<li><p><strong>initializer</strong> (<em>string</em>) – Initializer for autoencoder.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A keras clustering model.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Keras model</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="image-patch">
<h2>Image patch<a class="headerlink" href="#image-patch" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="antspynet.utilities.extract_image_patches">
<code class="sig-prename descclassname">antspynet.utilities.</code><code class="sig-name descname">extract_image_patches</code><span class="sig-paren">(</span><em class="sig-param">image</em>, <em class="sig-param">patch_size</em>, <em class="sig-param">max_number_of_patches='all'</em>, <em class="sig-param">stride_length=1</em>, <em class="sig-param">mask_image=None</em>, <em class="sig-param">random_seed=None</em>, <em class="sig-param">return_as_array=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/antspynet/utilities/extract_image_patches.html#extract_image_patches"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#antspynet.utilities.extract_image_patches" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract 2-D or 3-D image patches.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<em>ANTsImage</em>) – Input image with one or more components.</p></li>
<li><p><strong>patch_size</strong> (<em>n-D tuple</em><em> (</em><em>depending on dimensionality</em><em>)</em><em></em>) – Width, height, and depth (if 3-D) of patches.</p></li>
<li><p><strong>max_number_of_patches</strong> (<em>integer</em><em> or </em><em>string</em>) – Maximum number of patches returned.  If “all” is specified, then
all patches in sequence (defined by the stride_length are extracted.</p></li>
<li><p><strong>stride_length</strong> (<em>integer</em><em> or </em><em>n-D tuple</em>) – Defines the sequential patch overlap for max_number_of_patches = “all”.
Can be a image-dimensional vector or a scalar.</p></li>
<li><p><strong>mask_image</strong> (<em>ANTsImage</em><em> (</em><em>optional</em><em>)</em>) – Optional image specifying the sampling region for
the patches when max_number_of_patches does not equal “all”.
The way we constrain patch selection using a mask is by forcing
each returned patch to have a masked voxel at its center.</p></li>
<li><p><strong>random_seed</strong> (<em>integer</em><em> (</em><em>optional</em><em>)</em>) – Seed value that allows reproducible patch extraction across runs.</p></li>
<li><p><strong>return_as_array</strong> (<em>boolean</em>) – Specifies the return type of the function.  If
False (default) the return type is a list where each element is
a single patch.  Otherwise the return type is an array of size
dim( number_of_patches, patch_size ).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>A list (or array) of patches.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ants</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">image_read</span><span class="p">(</span><span class="n">ants</span><span class="o">.</span><span class="n">get_ants_data</span><span class="p">(</span><span class="s1">&#39;r16&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_patches</span> <span class="o">=</span> <span class="n">extract_image_patches</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">patch_size</span><span class="o">=</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="antspynet.utilities.reconstruct_image_from_patches">
<code class="sig-prename descclassname">antspynet.utilities.</code><code class="sig-name descname">reconstruct_image_from_patches</code><span class="sig-paren">(</span><em class="sig-param">patches</em>, <em class="sig-param">domain_image</em>, <em class="sig-param">stride_length=1</em>, <em class="sig-param">domain_image_is_mask=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/antspynet/utilities/reconstruct_image_from_patches.html#reconstruct_image_from_patches"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#antspynet.utilities.reconstruct_image_from_patches" title="Permalink to this definition">¶</a></dt>
<dd><p>Reconstruct image from a list of patches.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>patches</strong> (<em>list</em><em> or </em><em>array of patches</em>) – List or array of patches defining an image.  Patches are assumed
to have the same format as returned by extract_image_patches.</p></li>
<li><p><strong>domain_image</strong> (<em>ANTs image</em>) – Image or mask to define the geometric information of the
reconstructed image.  If this is a mask image, the reconstruction will only
use patches in the mask.</p></li>
<li><p><strong>stride_length</strong> (<em>integer</em><em> or </em><em>n-D tuple</em>) – Defines the sequential patch overlap for max_number_of_patches = “all”.
Can be a image-dimensional vector or a scalar.</p></li>
<li><p><strong>domain_image_is_mask</strong> (<em>boolean</em>) – Boolean specifying whether the domain image is a
mask used to limit the region of reconstruction from the patches.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>An ANTs image.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ants</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">image_read</span><span class="p">(</span><span class="n">ants</span><span class="o">.</span><span class="n">get_ants_data</span><span class="p">(</span><span class="s1">&#39;r16&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_patches</span> <span class="o">=</span> <span class="n">extract_image_patches</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">patch_size</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span> <span class="n">stride_length</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reconstructed_image</span> <span class="o">=</span> <span class="n">reconstruct_image_from_patches</span><span class="p">(</span><span class="n">image_patches</span><span class="p">,</span> <span class="n">image</span><span class="p">,</span> <span class="n">stride_length</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="super-resolution">
<h2>Super-resolution<a class="headerlink" href="#super-resolution" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="antspynet.utilities.mse">
<code class="sig-prename descclassname">antspynet.utilities.</code><code class="sig-name descname">mse</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">y=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/antspynet/utilities/super_resolution_utilities.html#mse"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#antspynet.utilities.mse" title="Permalink to this definition">¶</a></dt>
<dd><p>Mean square error of a single image or between two images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>input image</em>) – ants input image</p></li>
<li><p><strong>y</strong> (<em>input image</em>) – ants input image</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Value.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">r16</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">image_read</span><span class="p">(</span><span class="n">ants</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;r16&quot;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r64</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">image_read</span><span class="p">(</span><span class="n">ants</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;r64&quot;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">value</span> <span class="o">=</span> <span class="n">mse</span><span class="p">(</span><span class="n">r16</span><span class="p">,</span> <span class="n">r64</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="antspynet.utilities.mae">
<code class="sig-prename descclassname">antspynet.utilities.</code><code class="sig-name descname">mae</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">y=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/antspynet/utilities/super_resolution_utilities.html#mae"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#antspynet.utilities.mae" title="Permalink to this definition">¶</a></dt>
<dd><p>Mean absolute error of a single image or between two images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>input image</em>) – ants input image</p></li>
<li><p><strong>y</strong> (<em>input image</em>) – ants input image</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Value</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">r16</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">image_read</span><span class="p">(</span><span class="n">ants</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;r16&quot;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r64</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">image_read</span><span class="p">(</span><span class="n">ants</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;r64&quot;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">value</span> <span class="o">=</span> <span class="n">mae</span><span class="p">(</span><span class="n">r16</span><span class="p">,</span> <span class="n">r64</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="antspynet.utilities.psnr">
<code class="sig-prename descclassname">antspynet.utilities.</code><code class="sig-name descname">psnr</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">y</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/antspynet/utilities/super_resolution_utilities.html#psnr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#antspynet.utilities.psnr" title="Permalink to this definition">¶</a></dt>
<dd><p>Peak signal-to-noise ratio between two images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>input image</em>) – ants input image</p></li>
<li><p><strong>y</strong> (<em>input image</em>) – ants input image</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Value</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">r16</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">image_read</span><span class="p">(</span><span class="n">ants</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;r16&quot;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r64</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">image_read</span><span class="p">(</span><span class="n">ants</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;r64&quot;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">value</span> <span class="o">=</span> <span class="n">psnr</span><span class="p">(</span><span class="n">r16</span><span class="p">,</span> <span class="n">r64</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="antspynet.utilities.ssim">
<code class="sig-prename descclassname">antspynet.utilities.</code><code class="sig-name descname">ssim</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">y</em>, <em class="sig-param">K=(0.01</em>, <em class="sig-param">0.03)</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/antspynet/utilities/super_resolution_utilities.html#ssim"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#antspynet.utilities.ssim" title="Permalink to this definition">¶</a></dt>
<dd><p>Structural similarity index (SSI) between two images.</p>
<p>Implementation of the SSI quantity for two images proposed in</p>
<p>Z. Wang, A.C. Bovik, H.R. Sheikh, E.P. Simoncelli. “Image quality
assessment: from error visibility to structural similarity”. IEEE TIP.
13 (4): 600–612.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>input image</em>) – ants input image</p></li>
<li><p><strong>y</strong> (<em>input image</em>) – ants input image</p></li>
<li><p><strong>K</strong> (<em>tuple of length 2</em>) – tuple which contain SSI parameters meant to stabilize the formula
in case of weak denominators.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Value</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">r16</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">image_read</span><span class="p">(</span><span class="n">ants</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;r16&quot;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r64</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">image_read</span><span class="p">(</span><span class="n">ants</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;r64&quot;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">value</span> <span class="o">=</span> <span class="n">psnr</span><span class="p">(</span><span class="n">r16</span><span class="p">,</span> <span class="n">r64</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="antspynet.utilities.gmsd">
<code class="sig-prename descclassname">antspynet.utilities.</code><code class="sig-name descname">gmsd</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">y</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/antspynet/utilities/super_resolution_utilities.html#gmsd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#antspynet.utilities.gmsd" title="Permalink to this definition">¶</a></dt>
<dd><p>Gradient magnitude similarity deviation</p>
<p>A fast and simple metric that correlates to perceptual quality.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>input image</em>) – ants input image</p></li>
<li><p><strong>y</strong> (<em>input image</em>) – ants input image</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Value</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">r16</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">image_read</span><span class="p">(</span><span class="n">ants</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;r16&quot;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r64</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">image_read</span><span class="p">(</span><span class="n">ants</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;r64&quot;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">value</span> <span class="o">=</span> <span class="n">gmsd</span><span class="p">(</span><span class="n">r16</span><span class="p">,</span> <span class="n">r64</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="antspynet.utilities.apply_super_resolution_model_to_image">
<code class="sig-prename descclassname">antspynet.utilities.</code><code class="sig-name descname">apply_super_resolution_model_to_image</code><span class="sig-paren">(</span><em class="sig-param">image</em>, <em class="sig-param">model</em>, <em class="sig-param">target_range=(-127.5</em>, <em class="sig-param">127.5)</em>, <em class="sig-param">batch_size=32</em>, <em class="sig-param">regression_order=None</em>, <em class="sig-param">verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/antspynet/utilities/super_resolution_utilities.html#apply_super_resolution_model_to_image"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#antspynet.utilities.apply_super_resolution_model_to_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply a pretrained deep back projection model for super resolution.
Helper function for applying a pretrained deep back projection model.
Apply a patch-wise trained network to perform super-resolution. Can be applied
to variable sized inputs. Warning: This function may be better used on CPU
unless the GPU can accommodate the full image size. Warning 2: The global
intensity range (min to max) of the output will match the input where the
range is taken over all channels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<em>ANTs image</em>) – input image.</p></li>
<li><p><strong>model</strong> (<em>keras object</em><em> or </em><em>string</em>) – pretrained keras model or filename.</p></li>
<li><p><strong>target_range</strong> (<em>2-element tuple</em>) – a tuple or array defining the (min, max) of the input image
(e.g., -127.5, 127.5).  Output images will be scaled back to original
intensity. This range should match the mapping used in the training
of the network.</p></li>
<li><p><strong>batch_size</strong> (<em>integer</em>) – Batch size used for the prediction call.</p></li>
<li><p><strong>regression_order</strong> (<em>integer</em>) – If specified, Apply the function regression_match_image with
poly_order=regression_order.</p></li>
<li><p><strong>verbose</strong> (<em>boolean</em>) – If True, show status messages.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Super-resolution image upscaled to resolution specified by the network.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ants</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">image_read</span><span class="p">(</span><span class="n">ants</span><span class="o">.</span><span class="n">get_ants_data</span><span class="p">(</span><span class="s1">&#39;r16&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_sr</span> <span class="o">=</span> <span class="n">apply_super_resolution_model_to_image</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">get_pretrained_network</span><span class="p">(</span><span class="s2">&quot;dbpn4x&quot;</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="spatial-transformer-network">
<h2>Spatial transformer network<a class="headerlink" href="#spatial-transformer-network" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="antspynet.utilities.SpatialTransformer2D">
<em class="property">class </em><code class="sig-prename descclassname">antspynet.utilities.</code><code class="sig-name descname">SpatialTransformer2D</code><span class="sig-paren">(</span><em class="sig-param">resampled_size</em>, <em class="sig-param">transform_type='affine'</em>, <em class="sig-param">interpolator_type='linear'</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/antspynet/utilities/spatial_transformer_network_utilities.html#SpatialTransformer2D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#antspynet.utilities.SpatialTransformer2D" title="Permalink to this definition">¶</a></dt>
<dd><p>Custom layer for the spatial transfomer network.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong> (<em>list of size 2</em>) – The first element are the images and the second element are the
weights.</p></li>
<li><p><strong>resampled_size</strong> (<em>tuple of length 2</em>) – Size of the resampled output images.</p></li>
<li><p><strong>transform_type</strong> (<em>string</em>) – Transform type (default = ‘affine’).</p></li>
<li><p><strong>interpolator_type</strong> (<em>string</em>) – Interpolator type (default = ‘linear’).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A 2-D keras layer</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Keras layer</p>
</dd>
</dl>
</dd></dl>

<dl class="class">
<dt id="antspynet.utilities.SpatialTransformer3D">
<em class="property">class </em><code class="sig-prename descclassname">antspynet.utilities.</code><code class="sig-name descname">SpatialTransformer3D</code><span class="sig-paren">(</span><em class="sig-param">resampled_size</em>, <em class="sig-param">transform_type='affine'</em>, <em class="sig-param">interpolator_type='linear'</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/antspynet/utilities/spatial_transformer_network_utilities.html#SpatialTransformer3D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#antspynet.utilities.SpatialTransformer3D" title="Permalink to this definition">¶</a></dt>
<dd><p>Custom layer for the spatial transfomer network.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong> (<em>list of size 2</em>) – The first element are the images and the second element are the
weights.</p></li>
<li><p><strong>resampled_size</strong> (<em>tuple of length 3</em>) – Size of the resampled output images.</p></li>
<li><p><strong>transform_type</strong> (<em>string</em>) – Transform type (default = ‘affine’).</p></li>
<li><p><strong>interpolator_type</strong> (<em>string</em>) – Interpolator type (default = ‘linear’).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A 3-D keras layer</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Keras layer</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="applications">
<h2>Applications<a class="headerlink" href="#applications" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="antspynet.utilities.brain_extraction">
<code class="sig-prename descclassname">antspynet.utilities.</code><code class="sig-name descname">brain_extraction</code><span class="sig-paren">(</span><em class="sig-param">image</em>, <em class="sig-param">modality='t1'</em>, <em class="sig-param">output_directory=None</em>, <em class="sig-param">verbose=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/antspynet/utilities/brain_extraction.html#brain_extraction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#antspynet.utilities.brain_extraction" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform brain extraction using U-net and ANTs-based training data.  “NoBrainer”
is also possible where brain extraction uses U-net and FreeSurfer training data
ported from the</p>
<p><a class="reference external" href="https://github.com/neuronets/nobrainer-models">https://github.com/neuronets/nobrainer-models</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<em>ANTsImage</em>) – input image (or list of images for multi-modal scenarios).</p></li>
<li><p><strong>modality</strong> (<em>string</em>) – <dl class="simple">
<dt>Modality image type.  Options include:</dt><dd><ul>
<li><p>”t1”: T1-weighted MRI—ANTs-trained.</p></li>
<li><p>”t1nobrainer”: T1-weighted MRI—FreeSurfer-trained: h/t Satra Ghosh and Jakub Kaczmarzyk.</p></li>
<li><dl class="simple">
<dt>”t1combined”: Brian’s combination of “t1” and “t1nobrainer”.  One can also specify</dt><dd><p>”t1combined[X]” where X is the morphological radius.  X = 12 by default.</p>
</dd>
</dl>
</li>
<li><p>”flair”: FLAIR MRI.</p></li>
<li><p>”t2”: T2 MRI.</p></li>
<li><p>”bold”: 3-D BOLD MRI.</p></li>
<li><p>”fa”: Fractional anisotropy.</p></li>
<li><p>”t1t2infant”: Combined T1-w/T2-w infant MRI h/t Martin Styner.</p></li>
<li><p>”t1infant”: T1-w infant MRI h/t Martin Styner.</p></li>
<li><p>”t2infant”: T2-w infant MRI h/t Martin Styner.</p></li>
</ul>
</dd>
</dl>
</p></li>
<li><p><strong>output_directory</strong> (<em>string</em>) – Destination directory for storing the downloaded template and model weights.
Since these can be resused, if is None, these data will be downloaded to a
tempfile.</p></li>
<li><p><strong>verbose</strong> (<em>boolean</em>) – Print progress to the screen.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ANTs probability brain mask image.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">probability_brain_mask</span> <span class="o">=</span> <span class="n">brain_extraction</span><span class="p">(</span><span class="n">brain_image</span><span class="p">,</span> <span class="n">modality</span><span class="o">=</span><span class="s2">&quot;t1&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="antspynet.utilities.lung_extraction">
<code class="sig-prename descclassname">antspynet.utilities.</code><code class="sig-name descname">lung_extraction</code><span class="sig-paren">(</span><em class="sig-param">image</em>, <em class="sig-param">modality='proton'</em>, <em class="sig-param">output_directory=None</em>, <em class="sig-param">verbose=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/antspynet/utilities/lung_extraction.html#lung_extraction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#antspynet.utilities.lung_extraction" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform proton or ct lung extraction using U-net.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<em>ANTsImage</em>) – input image</p></li>
<li><p><strong>modality</strong> (<em>string</em>) – Modality image type.  Options include “ct” and “proton”.</p></li>
<li><p><strong>output_directory</strong> (<em>string</em>) – Destination directory for storing the downloaded template and model weights.
Since these can be resused, if is None, these data will be downloaded to a
tempfile.</p></li>
<li><p><strong>verbose</strong> (<em>boolean</em>) – Print progress to the screen.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Dictionary of ANTs segmentation and probability images.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">lung_extraction</span><span class="p">(</span><span class="n">lung_image</span><span class="p">,</span> <span class="n">modality</span><span class="o">=</span><span class="s2">&quot;proton&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="antspynet.utilities.preprocess_brain_image">
<code class="sig-prename descclassname">antspynet.utilities.</code><code class="sig-name descname">preprocess_brain_image</code><span class="sig-paren">(</span><em class="sig-param">image</em>, <em class="sig-param">truncate_intensity=(0.01</em>, <em class="sig-param">0.99)</em>, <em class="sig-param">do_brain_extraction=True</em>, <em class="sig-param">template_transform_type=None</em>, <em class="sig-param">template='biobank'</em>, <em class="sig-param">do_bias_correction=True</em>, <em class="sig-param">return_bias_field=False</em>, <em class="sig-param">do_denoising=True</em>, <em class="sig-param">intensity_matching_type=None</em>, <em class="sig-param">reference_image=None</em>, <em class="sig-param">intensity_normalization_type=None</em>, <em class="sig-param">output_directory=None</em>, <em class="sig-param">verbose=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/antspynet/utilities/preprocess_image.html#preprocess_brain_image"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#antspynet.utilities.preprocess_brain_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Basic preprocessing pipeline for T1-weighted brain MRI</p>
<p>Standard preprocessing steps that have been previously described
in various papers including the cortical thickness pipeline:</p>
<blockquote>
<div><p><a class="reference external" href="https://www.ncbi.nlm.nih.gov/pubmed/24879923">https://www.ncbi.nlm.nih.gov/pubmed/24879923</a></p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<em>ANTsImage</em>) – input image</p></li>
<li><p><strong>truncate_intensity</strong> (<em>2-length tuple</em>) – Defines the quantile threshold for truncating the image intensity</p></li>
<li><p><strong>do_brain_extraction</strong> (<em>boolean</em>) – Perform brain extraction using antspynet tools (3D images only).</p></li>
<li><p><strong>template_transform_type</strong> (<em>string</em>) – See details in help for ants.registration.  Typically “Rigid” or
“Affine”.</p></li>
<li><p><strong>template</strong> (<em>ANTs image</em><em> (</em><em>not skull-stripped</em><em>)</em>) – Alternatively, one can specify the default “biobank” or “croppedMni152”
to download and use premade templates.</p></li>
<li><p><strong>do_bias_correction</strong> (<em>boolean</em>) – Perform N4 bias field correction.</p></li>
<li><p><strong>return_bias_field</strong> (<em>boolean</em>) – If True, return bias field as an additional output <em>without</em> bias
correcting the preprocessed image.</p></li>
<li><p><strong>do_denoising</strong> (<em>boolean</em>) – Perform non-local means denoising.</p></li>
<li><p><strong>intensity_matching_type</strong> (<em>string</em>) – Either “regression” or “histogram”. Only is performed if reference_image
is not None.</p></li>
<li><p><strong>reference_image</strong> (<em>ANTs image</em>) – Reference image for intensity matching.</p></li>
<li><p><strong>intensity_normalization_type</strong> (<em>string</em>) – Either rescale the intensities to [0,1] (i.e., “01”) or zero-mean, unit variance
(i.e., “0mean”).  If None normalization is not performed.</p></li>
<li><p><strong>output_directory</strong> (<em>string</em>) – Destination directory for storing the downloaded template and model weights.
Since these can be resused, if is None, these data will be downloaded to a
tempfile.</p></li>
<li><p><strong>verbose</strong> (<em>boolean</em>) – Print progress to the screen.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>Dictionary with preprocessing information ANTs image (i.e., source_image) matched to the</em></p></li>
<li><p><em>(reference_image).</em></p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ants</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">image_read</span><span class="p">(</span><span class="n">ants</span><span class="o">.</span><span class="n">get_ants_data</span><span class="p">(</span><span class="s1">&#39;r16&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">preprocessed_image</span> <span class="o">=</span> <span class="n">preprocess_brain_image</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">do_brain_extraction</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="antspynet.utilities.sysu_media_wmh_segmentation">
<code class="sig-prename descclassname">antspynet.utilities.</code><code class="sig-name descname">sysu_media_wmh_segmentation</code><span class="sig-paren">(</span><em class="sig-param">flair</em>, <em class="sig-param">t1=None</em>, <em class="sig-param">do_preprocessing=True</em>, <em class="sig-param">use_ensemble=True</em>, <em class="sig-param">use_axial_slices_only=True</em>, <em class="sig-param">output_directory=None</em>, <em class="sig-param">verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/antspynet/utilities/white_matter_hyperintensity_segmentation.html#sysu_media_wmh_segmentation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#antspynet.utilities.sysu_media_wmh_segmentation" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform WMH segmentation using the winning submission in the MICCAI
2017 challenge by the sysu_media team using FLAIR or T1/FLAIR.  The
MICCAI challenge is discussed in</p>
<p><a class="reference external" href="https://pubmed.ncbi.nlm.nih.gov/30908194/">https://pubmed.ncbi.nlm.nih.gov/30908194/</a></p>
<p>with the sysu_media’s team entry is discussed in</p>
<blockquote>
<div><p><a class="reference external" href="https://pubmed.ncbi.nlm.nih.gov/30125711/">https://pubmed.ncbi.nlm.nih.gov/30125711/</a></p>
</div></blockquote>
<p>with the original implementation available here:</p>
<p><a class="reference external" href="https://github.com/hongweilibran/wmh_ibbmTum">https://github.com/hongweilibran/wmh_ibbmTum</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>flair</strong> (<em>ANTsImage</em>) – input 3-D FLAIR brain image (not skull-stripped).</p></li>
<li><p><strong>t1</strong> (<em>ANTsImage</em>) – input 3-D T1 brain image (not skull-stripped).</p></li>
<li><p><strong>do_preprocessing</strong> (<em>boolean</em>) – perform n4 bias correction?</p></li>
<li><p><strong>use_ensemble</strong> (<em>boolean</em>) – check whether to use all 3 sets of weights.</p></li>
<li><p><strong>output_directory</strong> (<em>string</em>) – Destination directory for storing the downloaded template and model weights.
Since these can be resused, if is None, these data will be downloaded to a
tempfile.</p></li>
<li><p><strong>use_axial_slices_only</strong> (<em>boolean</em>) – If True, use original implementation which was trained on axial slices.
If False, use ANTsXNet variant implementation which applies the slice-by-slice
models to all 3 dimensions and averages the results.</p></li>
<li><p><strong>verbose</strong> (<em>boolean</em>) – Print progress to the screen.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>WMH segmentation probability image</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">image_read</span><span class="p">(</span><span class="s2">&quot;flair.nii.gz&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">probability_mask</span> <span class="o">=</span> <span class="n">sysu_media_wmh_segmentation</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="antspynet.utilities.hippmapp3r_segmentation">
<code class="sig-prename descclassname">antspynet.utilities.</code><code class="sig-name descname">hippmapp3r_segmentation</code><span class="sig-paren">(</span><em class="sig-param">image</em>, <em class="sig-param">output_directory=None</em>, <em class="sig-param">verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/antspynet/utilities/hippmapp3r_segmentation.html#hippmapp3r_segmentation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#antspynet.utilities.hippmapp3r_segmentation" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform HippMapp3r (hippocampal) segmentation described in</p>
<blockquote>
<div><p><a class="reference external" href="https://www.ncbi.nlm.nih.gov/pubmed/31609046">https://www.ncbi.nlm.nih.gov/pubmed/31609046</a></p>
</div></blockquote>
<p>with models and architecture ported from</p>
<p><a class="reference external" href="https://github.com/mgoubran/HippMapp3r">https://github.com/mgoubran/HippMapp3r</a></p>
<p>Additional documentation and attribution resources found at</p>
<p><a class="reference external" href="https://hippmapp3r.readthedocs.io/en/latest/">https://hippmapp3r.readthedocs.io/en/latest/</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<em>ANTsImage</em>) – input image</p></li>
<li><p><strong>output_directory</strong> (<em>string</em>) – Destination directory for storing the downloaded template and model weights.
Since these can be resused, if is None, these data will be downloaded to a
tempfile.</p></li>
<li><p><strong>verbose</strong> (<em>boolean</em>) – Print progress to the screen.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ANTs probability hippocampal image.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">probability_mask</span> <span class="o">=</span> <span class="n">hippmapp3r_segmentation</span><span class="p">(</span><span class="n">t1</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="antspynet.utilities.deep_flash">
<code class="sig-prename descclassname">antspynet.utilities.</code><code class="sig-name descname">deep_flash</code><span class="sig-paren">(</span><em class="sig-param">t1</em>, <em class="sig-param">do_preprocessing=True</em>, <em class="sig-param">output_directory=None</em>, <em class="sig-param">verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/antspynet/utilities/deep_flash.html#deep_flash"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#antspynet.utilities.deep_flash" title="Permalink to this definition">¶</a></dt>
<dd><p>Hippocampal/Enthorhinal segmentation using “Deep Flash”</p>
<p>Perform hippocampal/entorhinal segmentation in T1 images using
labels from Mike Yassa’s lab</p>
<p><a class="reference external" href="https://faculty.sites.uci.edu/myassa/">https://faculty.sites.uci.edu/myassa/</a></p>
<p>The labeling is as follows:
Label 0 :  background
Label 5 :  left aLEC
Label 6 :  right aLEC
Label 7 :  left pMEC
Label 8 :  right pMEC
Label 9 :  left perirhinal
Label 10:  right perirhinal
Label 11:  left parahippocampal
Label 12:  right parahippocampal
Label 13:  left DG/CA3
Label 14:  right DG/CA3
Label 15:  left CA1
Label 16:  right CA1
Label 17:  left subiculum
Label 18:  right subiculum</p>
<dl class="simple">
<dt>Preprocessing on the training data consisted of:</dt><dd><ul class="simple">
<li><p>n4 bias correction,</p></li>
<li><p>denoising,</p></li>
<li><p>brain extraction, and</p></li>
<li><p>affine registration to MNI.</p></li>
</ul>
</dd>
</dl>
<p>The input T1 should undergo the same steps.  If the input T1 is the raw
T1, these steps can be performed by the internal preprocessing, i.e. set
do_preprocessing = True</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t1</strong> (<em>ANTsImage</em>) – raw or preprocessed 3-D T1-weighted brain image.</p></li>
<li><p><strong>do_preprocessing</strong> (<em>boolean</em>) – See description above.</p></li>
<li><p><strong>output_directory</strong> (<em>string</em>) – Destination directory for storing the downloaded template and model weights.
Since these can be resused, if is None, these data will be downloaded to a
tempfile.</p></li>
<li><p><strong>verbose</strong> (<em>boolean</em>) – Print progress to the screen.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>List consisting of the segmentation image and probability images for</em></p></li>
<li><p><em>each label.</em></p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">image_read</span><span class="p">(</span><span class="s2">&quot;t1.nii.gz&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flash</span> <span class="o">=</span> <span class="n">deep_flash</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="antspynet.utilities.deep_atropos">
<code class="sig-prename descclassname">antspynet.utilities.</code><code class="sig-name descname">deep_atropos</code><span class="sig-paren">(</span><em class="sig-param">t1</em>, <em class="sig-param">do_preprocessing=True</em>, <em class="sig-param">output_directory=None</em>, <em class="sig-param">verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/antspynet/utilities/deep_atropos.html#deep_atropos"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#antspynet.utilities.deep_atropos" title="Permalink to this definition">¶</a></dt>
<dd><p>Six-tissue segmentation.</p>
<p>Perform Atropos-style six tissue segmentation using deep learning.</p>
<p>The labeling is as follows:
Label 0 :  background
Label 1 :  CSF
Label 2 :  gray matter
Label 3 :  white matter
Label 4 :  deep gray matter
Label 5 :  brain stem
Label 6 :  cerebellum</p>
<dl class="simple">
<dt>Preprocessing on the training data consisted of:</dt><dd><ul class="simple">
<li><p>n4 bias correction,</p></li>
<li><p>denoising,</p></li>
<li><p>brain extraction, and</p></li>
<li><p>affine registration to MNI.</p></li>
</ul>
</dd>
</dl>
<p>The input T1 should undergo the same steps.  If the input T1 is the raw
T1, these steps can be performed by the internal preprocessing, i.e. set
do_preprocessing = True</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t1</strong> (<em>ANTsImage</em>) – raw or preprocessed 3-D T1-weighted brain image.</p></li>
<li><p><strong>do_preprocessing</strong> (<em>boolean</em>) – See description above.</p></li>
<li><p><strong>output_directory</strong> (<em>string</em>) – Destination directory for storing the downloaded template and model weights.
Since these can be resused, if is None, these data will be downloaded to a
tempfile.</p></li>
<li><p><strong>verbose</strong> (<em>boolean</em>) – Print progress to the screen.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>List consisting of the segmentation image and probability images for</em></p></li>
<li><p><em>each label.</em></p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">image_read</span><span class="p">(</span><span class="s2">&quot;t1.nii.gz&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flash</span> <span class="o">=</span> <span class="n">deep_atropos</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="antspynet.utilities.desikan_killiany_tourville_labeling">
<code class="sig-prename descclassname">antspynet.utilities.</code><code class="sig-name descname">desikan_killiany_tourville_labeling</code><span class="sig-paren">(</span><em class="sig-param">t1</em>, <em class="sig-param">do_preprocessing=True</em>, <em class="sig-param">output_directory=None</em>, <em class="sig-param">verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/antspynet/utilities/desikan_killiany_tourville_labeling.html#desikan_killiany_tourville_labeling"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#antspynet.utilities.desikan_killiany_tourville_labeling" title="Permalink to this definition">¶</a></dt>
<dd><p>Cortical and deep gray matter labeling using Desikan-Killiany-Tourville</p>
<p>Perform Atropos-style six tissue segmentation using deep learning</p>
<p>The labeling is as follows:</p>
<p>Inner labels:
Label 0: background
Label 4: left lateral ventricle
Label 5: left inferior lateral ventricle
Label 6: left cerebellem exterior
Label 7: left cerebellum white matter
Label 10: left thalamus proper
Label 11: left caudate
Label 12: left putamen
Label 13: left pallidium
Label 15: 4th ventricle
Label 16: brain stem
Label 17: left hippocampus
Label 18: left amygdala
Label 24: CSF
Label 25: left lesion
Label 26: left accumbens area
Label 28: left ventral DC
Label 30: left vessel
Label 43: right lateral ventricle
Label 44: right inferior lateral ventricle
Label 45: right cerebellum exterior
Label 46: right cerebellum white matter
Label 49: right thalamus proper
Label 50: right caudate
Label 51: right putamen
Label 52: right palladium
Label 53: right hippocampus
Label 54: right amygdala
Label 57: right lesion
Label 58: right accumbens area
Label 60: right ventral DC
Label 62: right vessel
Label 72: 5th ventricle
Label 85: optic chasm
Label 91: left basal forebrain
Label 92: right basal forebrain
Label 630: cerebellar vermal lobules I-V
Label 631: cerebellar vermal lobules VI-VII
Label 632: cerebellar vermal lobules VIII-X</p>
<p>Outer labels:
Label 1002: left caudal anterior cingulate
Label 1003: left caudal middle frontal
Label 1005: left cuneus
Label 1006: left entorhinal
Label 1007: left fusiform
Label 1008: left inferior parietal
Label 1009: left inferior temporal
Label 1010: left isthmus cingulate
Label 1011: left lateral occipital
Label 1012: left lateral orbitofrontal
Label 1013: left lingual
Label 1014: left medial orbitofrontal
Label 1015: left middle temporal
Label 1016: left parahippocampal
Label 1017: left paracentral
Label 1018: left pars opercularis
Label 1019: left pars orbitalis
Label 1020: left pars triangularis
Label 1021: left pericalcarine
Label 1022: left postcentral
Label 1023: left posterior cingulate
Label 1024: left precentral
Label 1025: left precuneus
Label 1026: left rostral anterior cingulate
Label 1027: left rostral middle frontal
Label 1028: left superior frontal
Label 1029: left superior parietal
Label 1030: left superior temporal
Label 1031: left supramarginal
Label 1034: left transverse temporal
Label 1035: left insula
Label 2002: right caudal anterior cingulate
Label 2003: right caudal middle frontal
Label 2005: right cuneus
Label 2006: right entorhinal
Label 2007: right fusiform
Label 2008: right inferior parietal
Label 2009: right inferior temporal
Label 2010: right isthmus cingulate
Label 2011: right lateral occipital
Label 2012: right lateral orbitofrontal
Label 2013: right lingual
Label 2014: right medial orbitofrontal
Label 2015: right middle temporal
Label 2016: right parahippocampal
Label 2017: right paracentral
Label 2018: right pars opercularis
Label 2019: right pars orbitalis
Label 2020: right pars triangularis
Label 2021: right pericalcarine
Label 2022: right postcentral
Label 2023: right posterior cingulate
Label 2024: right precentral
Label 2025: right precuneus
Label 2026: right rostral anterior cingulate
Label 2027: right rostral middle frontal
Label 2028: right superior frontal
Label 2029: right superior parietal
Label 2030: right superior temporal
Label 2031: right supramarginal
Label 2034: right transverse temporal
Label 2035: right insula</p>
<dl class="simple">
<dt>Preprocessing on the training data consisted of:</dt><dd><ul class="simple">
<li><p>n4 bias correction,</p></li>
<li><p>denoising,</p></li>
<li><p>brain extraction, and</p></li>
<li><p>affine registration to MNI.</p></li>
</ul>
</dd>
</dl>
<p>The input T1 should undergo the same steps.  If the input T1 is the raw
T1, these steps can be performed by the internal preprocessing, i.e. set
do_preprocessing = True</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t1</strong> (<em>ANTsImage</em>) – raw or preprocessed 3-D T1-weighted brain image.</p></li>
<li><p><strong>do_preprocessing</strong> (<em>boolean</em>) – See description above.</p></li>
<li><p><strong>output_directory</strong> (<em>string</em>) – Destination directory for storing the downloaded template and model weights.
Since these can be resused, if is None, these data will be downloaded to a
tempfile.</p></li>
<li><p><strong>verbose</strong> (<em>boolean</em>) – Print progress to the screen.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>List consisting of the segmentation image and probability images for</em></p></li>
<li><p><em>each label.</em></p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">image_read</span><span class="p">(</span><span class="s2">&quot;t1.nii.gz&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flash</span> <span class="o">=</span> <span class="n">desikan_killiany_tourville_labeling</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="antspynet.utilities.brain_age">
<code class="sig-prename descclassname">antspynet.utilities.</code><code class="sig-name descname">brain_age</code><span class="sig-paren">(</span><em class="sig-param">t1</em>, <em class="sig-param">do_preprocessing=True</em>, <em class="sig-param">number_of_simulations=0</em>, <em class="sig-param">sd_affine=0.01</em>, <em class="sig-param">output_directory=None</em>, <em class="sig-param">verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/antspynet/utilities/brain_age.html#brain_age"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#antspynet.utilities.brain_age" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimate BrainAge from a T1-weighted MR image using the DeepBrainNet
architecture and weights described here:</p>
<p><a class="reference external" href="https://github.com/vishnubashyam/DeepBrainNet">https://github.com/vishnubashyam/DeepBrainNet</a></p>
<p>and described in the following article:</p>
<p><a class="reference external" href="https://academic.oup.com/brain/article-abstract/doi/10.1093/brain/awaa160/5863667?redirectedFrom=fulltext">https://academic.oup.com/brain/article-abstract/doi/10.1093/brain/awaa160/5863667?redirectedFrom=fulltext</a></p>
<dl class="simple">
<dt>Preprocessing on the training data consisted of:</dt><dd><ul class="simple">
<li><p>n4 bias correction,</p></li>
<li><p>brain extraction, and</p></li>
<li><p>affine registration to MNI.</p></li>
</ul>
</dd>
</dl>
<p>The input T1 should undergo the same steps.  If the input T1 is the raw
T1, these steps can be performed by the internal preprocessing, i.e. set
do_preprocessing = True</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t1</strong> (<em>ANTsImage</em>) – raw or preprocessed 3-D T1-weighted brain image.</p></li>
<li><p><strong>do_preprocessing</strong> (<em>boolean</em>) – See description above.</p></li>
<li><p><strong>output_directory</strong> (<em>string</em>) – Destination directory for storing the downloaded template and model weights.
Since these can be resused, if is None, these data will be downloaded to a
tempfile.</p></li>
<li><p><strong>number_of_simulations</strong> (<em>integer</em>) – Number of random affine perturbations to transform the input.</p></li>
<li><p><strong>sd_affine</strong> (<em>float</em>) – Define the standard deviation of the affine transformation parameter.</p></li>
<li><p><strong>verbose</strong> (<em>boolean</em>) – Print progress to the screen.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>List consisting of the segmentation image and probability images for</em></p></li>
<li><p><em>each label.</em></p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">image_read</span><span class="p">(</span><span class="s2">&quot;t1.nii.gz&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">deep</span> <span class="o">=</span> <span class="n">brain_age</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Predicted age: &quot;</span><span class="p">,</span> <span class="n">deep</span><span class="p">[</span><span class="s1">&#39;predicted_age&#39;</span><span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="antspynet.utilities.mri_super_resolution">
<code class="sig-prename descclassname">antspynet.utilities.</code><code class="sig-name descname">mri_super_resolution</code><span class="sig-paren">(</span><em class="sig-param">image</em>, <em class="sig-param">output_directory=None</em>, <em class="sig-param">verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/antspynet/utilities/mri_super_resolution.html#mri_super_resolution"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#antspynet.utilities.mri_super_resolution" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform super-resolution (2x) of MRI data using deep back projection network.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<em>ANTsImage</em>) – magnetic resonance image</p></li>
<li><p><strong>output_directory</strong> (<em>string</em>) – Destination directory for storing the downloaded template and model weights.
Since these can be resused, if is None, these data will be downloaded to a
tempfile.</p></li>
<li><p><strong>verbose</strong> (<em>boolean</em>) – Print progress to the screen.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>List consisting of the segmentation image and probability images for</em></p></li>
<li><p><em>each label.</em></p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">image_read</span><span class="p">(</span><span class="s2">&quot;t1.nii.gz&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_sr</span> <span class="o">=</span> <span class="n">mri_super_resolution</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="antspynet.utilities.neural_style_transfer">
<code class="sig-prename descclassname">antspynet.utilities.</code><code class="sig-name descname">neural_style_transfer</code><span class="sig-paren">(</span><em class="sig-param">content_image, style_image, initial_combination_image=None, number_of_iterations=10, learning_rate=0.2, total_variation_weight=8.5e-05, content_weight=0.025, style_weights=[1.0], style_layer_names=['block1_conv1', 'block2_conv1', 'block3_conv1', 'block4_conv1', 'block5_conv1'], content_layer_names=['block5_conv2'], verbose=False, output_prefix=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/antspynet/utilities/neural_style_transfer.html#neural_style_transfer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#antspynet.utilities.neural_style_transfer" title="Permalink to this definition">¶</a></dt>
<dd><p>The popular neural style transfer described here:</p>
<p><a class="reference external" href="https://arxiv.org/abs/1508.06576">https://arxiv.org/abs/1508.06576</a></p>
<p>and taken from François Chollet’s implementation</p>
<p><a class="reference external" href="https://keras.io/examples/generative/neural_style_transfer/">https://keras.io/examples/generative/neural_style_transfer/</a></p>
<p>and titu1994’s modifications:</p>
<p><a class="reference external" href="https://github.com/titu1994/Neural-Style-Transfer">https://github.com/titu1994/Neural-Style-Transfer</a></p>
<p>in order to possibly modify and experiment with medical images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>content_image</strong> (<em>ANTsImage</em><em> (</em><em>1</em><em> or </em><em>3-component</em><em>)</em>) – Content (or base) image.</p></li>
<li><p><strong>style_image</strong> (<em>ANTsImage</em>) – Style (or reference) image.</p></li>
<li><p><strong>initial_combination_image</strong> (<em>ANTsImage</em><em> (</em><em>1</em><em> or </em><em>3-component</em><em>)</em>) – Starting point for the optimization.  Allows one to start from the
output from a previous run.  Otherwise, start from the content image.
Note that the original paper starts with a noise image.</p></li>
<li><p><strong>number_of_iterations</strong> (<em>integer</em>) – Number of gradient steps taken during optimization.</p></li>
<li><p><strong>initial_iteration_rate</strong> (<em>float</em>) – Parameter for SGD optimization with exponential decay.</p></li>
<li><p><strong>total_variation_weight</strong> (<em>float</em>) – A penalty on the regularization term to keep the features
of the output image locally coherent.</p></li>
<li><p><strong>style_weights</strong> (<em>list of floats</em>) – Weights of the style term in the optimization function for each
style layer.  Can either specify a single scalar to be used for
all the layers or one for each layer.  The
style term computes the sum of the L2 norm between the Gram
matrices of the different layers (using ImageNet-trained VGG)
of the style and content images.</p></li>
<li><p><strong>style_layer_names</strong> (<em>list of strings</em>) – Names of VGG layers from which to compute the style loss.  If “all”,
the layers used are [‘block1_conv1’, ‘block1_conv2’, ‘block2_conv1’,
‘block2_conv2’, ‘block3_conv1’, ‘block3_conv2’, ‘block3_conv3’,
‘block3_conv4’, ‘block4_conv1’, ‘block4_conv2’, ‘block4_conv3’,
‘block4_conv4’, ‘block5_conv1’, ‘block5_conv2’, ‘block5_conv3’,
‘block5_conv4’].  This is a proposed improvement from both Chollet’s
implementation/original paper.</p></li>
<li><p><strong>content_layer_names</strong> (<em>list of strings</em>) – Names of VGG layers from which to compute the content loss.</p></li>
<li><p><strong>content_weight</strong> (<em>float</em>) – Weight of the content term in the optimization function.  The
style term computes the sum of the L2 norm between the Gram
matrices of the different layers (using ImageNet-trained VGG)
of the content and output images.</p></li>
<li><p><strong>verbose</strong> (<em>boolean</em>) – Print progress to the screen.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ANTs 3-component image.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">neural_style_transfer</span><span class="p">(</span><span class="n">content_image</span><span class="p">,</span> <span class="n">style_image</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="miscellaneous">
<h2>Miscellaneous<a class="headerlink" href="#miscellaneous" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="antspynet.utilities.get_pretrained_network">
<code class="sig-prename descclassname">antspynet.utilities.</code><code class="sig-name descname">get_pretrained_network</code><span class="sig-paren">(</span><em class="sig-param">file_id=None</em>, <em class="sig-param">target_file_name=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/antspynet/utilities/get_pretrained_network.html#get_pretrained_network"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#antspynet.utilities.get_pretrained_network" title="Permalink to this definition">¶</a></dt>
<dd><p>Download pretrained network/weights.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>string</strong> (<em>target_file_name</em>) – One of the permitted file ids or pass “show” to list all
valid possibilities. Note that most require internet access
to download.</p></li>
<li><p><strong>string</strong> – Optional target filename.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>A filename string</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model_file</span> <span class="o">=</span> <span class="n">get_pretrained_network</span><span class="p">(</span> <span class="s1">&#39;dbpn4x&#39;</span> <span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="antspynet.utilities.Scale">
<em class="property">class </em><code class="sig-prename descclassname">antspynet.utilities.</code><code class="sig-name descname">Scale</code><span class="sig-paren">(</span><em class="sig-param">axis=-1</em>, <em class="sig-param">momentum=0.9</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/antspynet/utilities/denseunet_utilities.html#Scale"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#antspynet.utilities.Scale" title="Permalink to this definition">¶</a></dt>
<dd><p>Custom layer used in the Dense U-net class for normalization which
learns a set of weights and biases for scaling the input data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>axis</strong> (<em>integer</em>) – Specifies which axis to normalize.</p></li>
<li><p><strong>momentum</strong> (<em>scalar</em>) – Value used for computation of the exponential average of the
mean and standard deviation.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="antspynet.utilities.regression_match_image">
<code class="sig-prename descclassname">antspynet.utilities.</code><code class="sig-name descname">regression_match_image</code><span class="sig-paren">(</span><em class="sig-param">source_image</em>, <em class="sig-param">reference_image</em>, <em class="sig-param">mask=None</em>, <em class="sig-param">poly_order=1</em>, <em class="sig-param">truncate=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/antspynet/utilities/regression_match_image.html#regression_match_image"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#antspynet.utilities.regression_match_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Image intensity normalization using linear regression.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>source_image</strong> (<em>ANTsImage</em>) – Image whose intensities are matched to the reference
image.</p></li>
<li><p><strong>reference_image</strong> (<em>ANTsImage</em>) – Defines the reference intensity function.</p></li>
<li><p><strong>poly_order</strong> (<em>integer</em>) – Polynomial order of fit.  Default is 1 (linear fit).</p></li>
<li><p><strong>mask</strong> (<em>ANTsImage</em>) – Defines voxels for regression modeling.</p></li>
<li><p><strong>truncate</strong> (<em>boolean</em>) – Turns on/off the clipping of intensities.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ANTs image (i.e., source_image) matched to the (reference_image)</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ants</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">source_image</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">image_read</span><span class="p">(</span><span class="n">ants</span><span class="o">.</span><span class="n">get_ants_data</span><span class="p">(</span><span class="s1">&#39;r16&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reference_image</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">image_read</span><span class="p">(</span><span class="n">ants</span><span class="o">.</span><span class="n">get_ants_data</span><span class="p">(</span><span class="s1">&#39;r64&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">matched_image</span> <span class="o">=</span> <span class="n">regression_match_image</span><span class="p">(</span><span class="n">source_image</span><span class="p">,</span> <span class="n">reference_image</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="antspynet.utilities.randomly_transform_image_data">
<code class="sig-prename descclassname">antspynet.utilities.</code><code class="sig-name descname">randomly_transform_image_data</code><span class="sig-paren">(</span><em class="sig-param">reference_image</em>, <em class="sig-param">input_image_list</em>, <em class="sig-param">segmentation_image_list=None</em>, <em class="sig-param">number_of_simulations=10</em>, <em class="sig-param">transform_type='affine'</em>, <em class="sig-param">sd_affine=0.02</em>, <em class="sig-param">deformation_transform_type='bspline'</em>, <em class="sig-param">number_of_random_points=1000</em>, <em class="sig-param">sd_noise=10.0</em>, <em class="sig-param">number_of_fitting_levels=4</em>, <em class="sig-param">mesh_size=1</em>, <em class="sig-param">sd_smoothing=4.0</em>, <em class="sig-param">input_image_interpolator='linear'</em>, <em class="sig-param">segmentation_image_interpolator='nearestNeighbor'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/antspynet/utilities/randomly_transform_image_data.html#randomly_transform_image_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#antspynet.utilities.randomly_transform_image_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Randomly transform image data (optional: with corresponding segmentations).</p>
<p>Apply rigid, affine and/or deformable maps to an input set of training
images.  The reference image domain defines the space in which this
happens.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>reference_image</strong> (<em>ANTsImage</em>) – Defines the spatial domain for all output images.  If the input images do
not match the spatial domain of the reference image, we internally
resample the target to the reference image.  This could have unexpected
consequences.  Resampling to the reference domain is performed by testing
using ants.image_physical_space_consistency then calling
ants.resample_image_to_target with failure.</p></li>
<li><p><strong>input_image_list</strong> (<em>list of lists of ANTsImages</em>) – List of lists of input images to warp.  The internal list sets contain one
or more images (per subject) which are assumed to be mutually aligned.  The
outer list contains multiple subject lists which are randomly sampled to
produce output image list.</p></li>
<li><p><strong>segmentation_image_list</strong> (<em>list of ANTsImages</em>) – List of segmentation images corresponding to the input image list (optional).</p></li>
<li><p><strong>number_of_simulations</strong> (<em>integer</em>) – Number of output images.</p></li>
<li><p><strong>transform_type</strong> (<em>string</em>) – One of the following options: “translation”, “rigid”, “scaleShear”, “affine”,
“deformation”, “affineAndDeformation”.</p></li>
<li><p><strong>sd_affine</strong> (<em>float</em>) – Parameter dictating deviation amount from identity for random linear
transformations.</p></li>
<li><p><strong>deformation_transform_type</strong> (<em>string</em>) – “bspline” or “exponential”.</p></li>
<li><p><strong>number_of_random_points</strong> (<em>integer</em>) – Number of displacement points for the deformation field.</p></li>
<li><p><strong>sd_noise</strong> (<em>float</em>) – Standard deviation of the displacement field.</p></li>
<li><p><strong>number_of_fitting_levels</strong> (<em>integer</em>) – Number of fitting levels (bspline deformation only).</p></li>
<li><p><strong>mesh_size</strong> (<em>int</em><em> or </em><em>n-D tuple</em>) – Determines fitting resolution (bspline deformation only).</p></li>
<li><p><strong>sd_smoothing</strong> (<em>float</em>) – Standard deviation of the Gaussian smoothing in mm (exponential field only).</p></li>
<li><p><strong>input_image_interpolator</strong> (<em>string</em>) – One of the following options “linear”, “gaussian”, “bspline”.</p></li>
<li><p><strong>segmentation_image_interpolator</strong> (<em>string</em>) – One of the following options “nearestNeighbor” or “genericLabel”.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of lists of transformed images</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ants</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image1_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image1_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ants</span><span class="o">.</span><span class="n">image_read</span><span class="p">(</span><span class="n">ants</span><span class="o">.</span><span class="n">get_ants_data</span><span class="p">(</span><span class="s2">&quot;r16&quot;</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image2_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image2_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ants</span><span class="o">.</span><span class="n">image_read</span><span class="p">(</span><span class="n">ants</span><span class="o">.</span><span class="n">get_ants_data</span><span class="p">(</span><span class="s2">&quot;r64&quot;</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_segmentations</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_segmentations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ants</span><span class="o">.</span><span class="n">threshold_image</span><span class="p">(</span><span class="n">image1</span><span class="p">,</span> <span class="s2">&quot;Otsu&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_segmentations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ants</span><span class="o">.</span><span class="n">threshold_image</span><span class="p">(</span><span class="n">image2</span><span class="p">,</span> <span class="s2">&quot;Otsu&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_images</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_images</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">image1_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_images</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">image2_list</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">antspynet</span><span class="o">.</span><span class="n">randomly_transform_image_data</span><span class="p">(</span><span class="n">image1</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">input_images</span><span class="p">,</span> <span class="n">input_segmentations</span><span class="p">,</span> <span class="n">sd_affine</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">transform_type</span> <span class="o">=</span> <span class="s2">&quot;affineAndDeformation&quot;</span> <span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="antspynet.utilities.crop_image_center">
<code class="sig-prename descclassname">antspynet.utilities.</code><code class="sig-name descname">crop_image_center</code><span class="sig-paren">(</span><em class="sig-param">image</em>, <em class="sig-param">crop_size</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/antspynet/utilities/cropping_and_padding_utilities.html#crop_image_center"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#antspynet.utilities.crop_image_center" title="Permalink to this definition">¶</a></dt>
<dd><p>Crop the center of an image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<em>ANTsImage</em>) – Input image</p></li>
<li><p><strong>crop_size</strong> (<em>n-D tuple</em><em> (</em><em>depending on dimensionality</em><em>)</em><em></em>) – Width, height, depth (if 3-D), and time (if 4-D) of crop region.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>A list (or array) of patches.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ants</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">image_read</span><span class="p">(</span><span class="n">ants</span><span class="o">.</span><span class="n">get_ants_data</span><span class="p">(</span><span class="s1">&#39;r16&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cropped_image</span> <span class="o">=</span> <span class="n">crop_image_center</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">crop_size</span><span class="o">=</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="antspynet.utilities.pad_or_crop_image_to_size">
<code class="sig-prename descclassname">antspynet.utilities.</code><code class="sig-name descname">pad_or_crop_image_to_size</code><span class="sig-paren">(</span><em class="sig-param">image</em>, <em class="sig-param">size</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/antspynet/utilities/cropping_and_padding_utilities.html#pad_or_crop_image_to_size"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#antspynet.utilities.pad_or_crop_image_to_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Pad or crop an image to a specified size</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<em>ANTsImage</em>) – Input image</p></li>
<li><p><strong>size</strong> (<em>tuple</em>) – size of output image</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>A cropped or padded image</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ants</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">image_read</span><span class="p">(</span><span class="n">ants</span><span class="o">.</span><span class="n">get_ants_data</span><span class="p">(</span><span class="s1">&#39;r16&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">padded_image</span> <span class="o">=</span> <span class="n">pad_or_crop_image_to_size</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="p">(</span><span class="mi">333</span><span class="p">,</span> <span class="mi">333</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="antspynet.utilities.pad_image_by_factor">
<code class="sig-prename descclassname">antspynet.utilities.</code><code class="sig-name descname">pad_image_by_factor</code><span class="sig-paren">(</span><em class="sig-param">image</em>, <em class="sig-param">factor</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/antspynet/utilities/cropping_and_padding_utilities.html#pad_image_by_factor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#antspynet.utilities.pad_image_by_factor" title="Permalink to this definition">¶</a></dt>
<dd><p>Pad an image based on a factor.</p>
<p>Pad image of size (x, y, z) to (x’, y’, z’) where (x’, y’, z’)
is a divisible by a user-specified factor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<em>ANTsImage</em>) – Input image</p></li>
<li><p><strong>factor</strong> (<em>scalar</em><em> or </em><em>n-D tuple</em>) – Padding factor</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>A padded image</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">ants</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">ants</span><span class="o">.</span><span class="n">image_read</span><span class="p">(</span><span class="n">ants</span><span class="o">.</span><span class="n">get_ants_data</span><span class="p">(</span><span class="s1">&#39;r16&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">padded_image</span> <span class="o">=</span> <span class="n">pad_image_by_factor</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">factor</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">ANTsPyNet</a></h1>








<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="architectures.html">Architectures</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Utilities</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#custom-metrics">Custom metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="#custom-normalization-layers">Custom normalization layers</a></li>
<li class="toctree-l2"><a class="reference internal" href="#custom-activation-layers">Custom activation layers</a></li>
<li class="toctree-l2"><a class="reference internal" href="#resample-tensor-layer">Resample tensor layer</a></li>
<li class="toctree-l2"><a class="reference internal" href="#mixture-density-networks">Mixture density networks</a></li>
<li class="toctree-l2"><a class="reference internal" href="#attention">Attention</a></li>
<li class="toctree-l2"><a class="reference internal" href="#clustering">Clustering</a></li>
<li class="toctree-l2"><a class="reference internal" href="#image-patch">Image patch</a></li>
<li class="toctree-l2"><a class="reference internal" href="#super-resolution">Super-resolution</a></li>
<li class="toctree-l2"><a class="reference internal" href="#spatial-transformer-network">Spatial transformer network</a></li>
<li class="toctree-l2"><a class="reference internal" href="#applications">Applications</a></li>
<li class="toctree-l2"><a class="reference internal" href="#miscellaneous">Miscellaneous</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="architectures.html" title="previous chapter">Architectures</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2019, Nick Tustison, Nick Cullen, Brian Avants.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.4.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/utilities.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>